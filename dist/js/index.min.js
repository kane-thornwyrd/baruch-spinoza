var ULTRASTART=Date.now(),libLoad=function(e){var n,t,o,r,i,a=document.getElementsByTagName("script")[0],c=[],s=[],d=function(e){return!(void 0===e.dependOn||e.dependOn.length<=0)},l=function(t){return function(){console.log(t.name,"took",Date.now()-t.loadStart+"ms via",t.src),t.loaded=!0,c.push(t.name),h(e),i(n)}},u=function(e){return void 0!==e.loaded&&e.loaded||(e.loadStart=Date.now(),a.parentNode.insertBefore(e.el,a)),e},f=function(e){var n,t=!0;for(n=e.length-1;n>=0;n--)t&=-1===c.indexOf(e[n])!=!0;return t},h=function(e){for(var n in e)e.hasOwnProperty(n)&&d(e[n])&&f(e[n].dependOn)&&u(e[n])};for(t in e)e.hasOwnProperty(t)&&(s.push(t),o=e[t],r=document.createElement("script"),r.src=e[t].src,r.type="text/javascript",r.async="true",r.defer="true",r.onload=l(o),o.el=r,o.name=t,console.log("Dependencies",t,s),d(o)?f(o.dependOn)&&u(o):u(o));return i=function(e,n){return void 0===n&&(n={ID:0}),f(s)&&e.call(window),clearInterval(n.ID)},function(e){var t={ID:0};n=e,t.ID=i(e,t)}};libLoad({jquery:{src:"https://cdn.jsdelivr.net/jquery/2.1.4/jquery.min.js"},underscore:{src:"https://cdn.jsdelivr.net/underscorejs/1.8.3/underscore-min.js"},backbone:{src:"https://cdn.jsdelivr.net/backbonejs/1.2.1/backbone-min.js",dependOn:["jquery","underscore"]},marionette:{src:"https://cdn.jsdelivr.net/backbone.marionette/2.4.2/backbone.marionette.min.js",dependOn:["backbone"]}})(function(){var e,n=Backbone.Marionette,t={Models:{},Collections:{},Views:{}},o=function(){function e(e){var n;for(n=0;n<e.length;n+=1)e[n](d)}function n(){var n=l;s&&n.length&&(l=[],e(n))}function t(){s||(s=!0,a&&clearInterval(a),n())}function o(e){return s?e(d):l.push(e),o}var r,i,a,c="undefined"!=typeof window&&window.document,s=!c,d=c?document:null,l=[];if(c){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else if(window.attachEvent){window.attachEvent("onload",t),i=document.createElement("div");try{r=null===window.frameElement}catch(u){}i.doScroll&&r&&window.external&&(a=setInterval(function(){try{i.doScroll(),t()}catch(e){}},30))}"complete"===document.readyState&&t()}return o.version="2.0.1",o.load=function(e,n,t,r){r.isBuild?t(null):o(t)},o}(),r=[{request:"get:books",url:"http://henri-potier.xebia.fr/books"}],i=Backbone.Wreqr.radio.channel("data"),a=function(e,n,t){return function(){return $.ajax(n,_.extend({accepts:["text/json"],cache:!0,dataType:"json",ifModified:!0,complete:function(n,t){Backbone.Wreqr.radio.channel("data").vent.trigger(t,e,n.responseJSON,n)}},t))}},c=function(e){if(_.isArray(e.request))for(var n=0,t=e.request.length;t>n;n++)void 0===e.response?void 0!==e.url&&i.reqres.setHandler(e.request[n],a(e.request[n],e.url)):i.reqres.setHandler(e.request[n],e.response);else i.reqres.setHandler(e.request,a(e.request,e.url))};_.each(r,c),e=n.Application.extend({regions:{header:".site-header",mainContainer:".main-container"},defaults:{},initialize:function(e){return this.options=_.extend({},this.defaults,e),o(_.bind(function(){this.vent.trigger("domReady",this)},this)),console.log("App initialized"),this.listen()},listen:function(){return this.on("start",function(){console.log("START"),this.vent.on("domReady",function(){try{Backbone.history.start({pushState:!0}),console.log("BACKBONE HISTORY RUNNINGâ€¦")}catch(e){console.log(e)}})}),this}}),t.Models.Book=Backbone.Model.extend({defaults:{isbn:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",title:"default title",author:"Jeanne Catherine Rangeant",price:0,cover:"http://placekitten.com/g/200/300"}}),t.Collections.Book=Backbone.Collection.extend({model:t.Models.Book}),t.Views.BookCollection=Backbone.View.extend({tagName:"ul",render:function(){var e=this;o(function(){e.collection.each(function(){console.log("COloction: ",arguments)})})},renderBook:function(e){new t.Views.Book({model:e})}}),t.Views.BookCard=n.ItemView.extend({template:"#bookCard",initialize:function(){var e=Backbone.Wreqr.radio.channel("global");console.log("globalCh",e),e.vent.on("domReady",this.ping)},ping:function(){console.log("PING !")}}),t.Views.common=n.ItemView.extend(Backbone.Model.extend({"super":t.Views.common,constructor:function(){n.ItemView.apply(this,arguments)}})),new e({container:"body"}).start(),Backbone.Wreqr.radio.channel("data").vent.on("success",function(e){"get:books"===e&&console.log("GET BOOKS !",arguments)}),Backbone.Wreqr.radio.channel("data").reqres.request("get:books")});
//# sourceMappingURL=index.min.js.map