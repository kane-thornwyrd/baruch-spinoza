{"version":3,"sources":["index.js"],"names":["libLoad","libs","main","libKey","lib","el","tryMainLoad","rootScript","document","getElementsByTagName","loaded","mainDeps","hasDependencies","dependOn","length","resolvingCallback","push","name","reloadLibs","load","parentNode","insertBefore","allDependenciesMet","deps","i","okay","indexOf","hasOwnProperty","createElement","src","type","async","defer","onload","interval","ID","call","window","clearInterval","cb","retry","setInterval","jquery","underscore","backbone","marionette","materialize","conf","bookRegistryRequest","baruchSpinoza","Models","Collections","Views","domReady","runCallbacks","callbacks","doc","callReady","readyCalls","isPageLoaded","pageLoaded","scrollIntervalId","callback","isTop","testDiv","isBrowser","addEventListener","attachEvent","frameElement","e","doScroll","external","readyState","version","req","onLoad","config","isBuild","Book","Backbone","Model","extend","defaults","isbn","title","author","price","cover","Collection","model","BookCollection","View","tagName","render","self","this","collection","each","console","log","arguments","renderBook","book","template","_","className","initialize","listen","$el","html","toJSON","bookRegistry","url","settings","accepts","cache","dataType","ifModified","$","sideNav","addClass","hide","ajax","then","data","books"],"mappings":"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","file":"index.min.js","sourcesContent":["var libLoad = function libLoad(libs) {\n  var rootScript = document.getElementsByTagName(\"script\")[0];\n  var loaded = [], mainDeps = [], mainLoad, main;\n  var hasDependencies = function hasDependencies(lib) {\n    return !(typeof lib.dependOn === \"undefined\" || lib.dependOn.length <= 0);\n  };\n  var resolvingCallback = function resolvingCallback(lib) {\n    return function libLoaded() {\n      lib.loaded = true;\n      loaded.push(lib.name);\n      reloadLibs(libs);\n      tryMainLoad(main);\n    };\n  };\n  var load = function load(lib) {\n    if (typeof lib.loaded === \"undefined\" || !lib.loaded) {\n      rootScript.parentNode.insertBefore(lib.el, rootScript);\n    }\n    return lib;\n  };\n  var allDependenciesMet = function allDependenciesMet(deps) {\n    var okay = true;\n    for (var i = deps.length - 1; i >= 0; i--) {\n      okay = okay && !(loaded.indexOf(deps[i]) === -1);\n    }\n    return okay;\n  };\n  var reloadLibs = function reloadLibs(libs) {\n    for (var libKey in libs) {\n      if (libs.hasOwnProperty(libKey) && hasDependencies(libs[libKey]) && allDependenciesMet(libs[libKey].dependOn)) {\n        load(libs[libKey]);\n      }\n    }\n  };\n  for (var libKey in libs) {\n    if (libs.hasOwnProperty(libKey)) {\n      mainDeps.push(libKey);\n      var lib = libs[libKey];\n      var el = document.createElement(\"script\");\n      el.src = libs[libKey].src;\n      el.type = \"text/javascript\";\n      el.async = \"true\";\n      el.defer = \"true\";\n      el.onload = resolvingCallback(lib);\n      lib.el = el;\n      lib.name = libKey;\n      if (!hasDependencies(lib)) {\n        load(lib);\n      } else {\n        if (allDependenciesMet(lib.dependOn)) {\n          load(lib);\n        }\n      }\n    }\n  }\n  var tryMainLoad = function tryMainLoad(main, interval) {\n    if (typeof interval === \"undefined\") {\n      interval = {\n        \"ID\": 0\n      };\n    }\n    if (allDependenciesMet(mainDeps)) {\n      main.call(window);\n    }\n    clearInterval(interval.ID);\n  };\n  return function libsLoaded(cb) {\n    var retry = {\n      \"ID\": 0\n    };\n    main = cb;\n    retry.ID = setInterval(tryMainLoad, 100, cb, retry);\n  };\n};\n\nlibLoad({\n  \"jquery\": {\n    \"src\": \"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"\n  },\n  \"underscore\": {\n    \"src\": \"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore.js\"\n  },\n  \"backbone\": {\n    \"src\": \"https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.2.1/backbone-min.js\",\n    \"dependOn\": [ \"jquery\", \"underscore\" ]\n  },\n  \"marionette\": {\n    \"src\": \"https://cdnjs.cloudflare.com/ajax/libs/backbone.marionette/2.4.2/backbone.marionette.min.js\",\n    \"dependOn\": [ \"backbone\" ]\n  },\n  \"materialize\": {\n    \"src\": \"https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/js/materialize.min.js\",\n    \"dependOn\": [ \"jquery\" ]\n  }\n})(function libLoadedCallback() {\n  var baruchSpinoza = {\n    \"Models\": {},\n    \"Collections\": {},\n    \"Views\": {}\n  };\n  var domReady = function() {\n    var isTop, testDiv, scrollIntervalId, isBrowser = typeof window !== \"undefined\" && window.document, isPageLoaded = !isBrowser, doc = isBrowser ? document : null, readyCalls = [];\n    function runCallbacks(callbacks) {\n      var i;\n      for (i = 0; i < callbacks.length; i += 1) {\n        callbacks[i](doc);\n      }\n    }\n    function callReady() {\n      var callbacks = readyCalls;\n      if (isPageLoaded) {\n        if (callbacks.length) {\n          readyCalls = [];\n          runCallbacks(callbacks);\n        }\n      }\n    }\n    function pageLoaded() {\n      if (!isPageLoaded) {\n        isPageLoaded = true;\n        if (scrollIntervalId) {\n          clearInterval(scrollIntervalId);\n        }\n        callReady();\n      }\n    }\n    if (isBrowser) {\n      if (document.addEventListener) {\n        document.addEventListener(\"DOMContentLoaded\", pageLoaded, false);\n        window.addEventListener(\"load\", pageLoaded, false);\n      } else {\n        if (window.attachEvent) {\n          window.attachEvent(\"onload\", pageLoaded);\n          testDiv = document.createElement(\"div\");\n          try {\n            isTop = window.frameElement === null;\n          } catch (e) {}\n          if (testDiv.doScroll && isTop && window.external) {\n            scrollIntervalId = setInterval(function() {\n              try {\n                testDiv.doScroll();\n                pageLoaded();\n              } catch (e) {}\n            }, 30);\n          }\n        }\n      }\n      if (document.readyState === \"complete\") {\n        pageLoaded();\n      }\n    }\n    /**\r\n   * Registers a callback for DOM ready. If DOM is already ready, the\r\n   * callback is called immediately.\r\n   * @param {Function} callback\r\n   */\n    function domReady(callback) {\n      if (isPageLoaded) {\n        callback(doc);\n      } else {\n        readyCalls.push(callback);\n      }\n      return domReady;\n    }\n    domReady.version = \"2.0.1\";\n    domReady.load = function(name, req, onLoad, config) {\n      if (config.isBuild) {\n        onLoad(null);\n      } else {\n        domReady(onLoad);\n      }\n    };\n    return domReady;\n  }();\n  baruchSpinoza.Models.Book = Backbone.Model.extend({\n    \"defaults\": {\n      \"isbn\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\n      \"title\": \"default title\",\n      \"author\": \"Jeanne Catherine Rangeant\",\n      \"price\": 0,\n      \"cover\": \"http://placekitten.com/g/200/300\"\n    }\n  });\n  baruchSpinoza.Collections.Book = Backbone.Collection.extend({\n    \"model\": baruchSpinoza.Models.Book\n  });\n  baruchSpinoza.Views.BookCollection = Backbone.View.extend({\n    \"tagName\": \"ul\",\n    \"render\": function bookCollectionViewRender() {\n      var self = this;\n      domReady(function bookCollectionViewRenderDomReady() {\n        self.collection.each(function() {\n          console.log(\"COloction: \", arguments);\n        });\n      });\n    },\n    \"renderBook\": function bookCollectionViewRenderBook(book) {\n      var bookView = new baruchSpinoza.Views.Book({\n        \"model\": book\n      });\n    }\n  });\n  baruchSpinoza.Views.Book = Backbone.View.extend({\n    \"tagName\": \"section\",\n    \"template\": _.template('<section><img src=\"<%= cover %>\" /><h1><%= title %> - <%= author %></h1><p><em><%= price %></em><small><%= isbn %></small></p></section>'),\n    \"className\": \"book\",\n    \"initialize\": function bookViewInitialize() {\n      this.listen(this.model, \"change\", this.render);\n      this.render();\n    },\n    \"render\": function bookViewRender() {\n      var self = this;\n      self.$el.html(self.template(self.model.toJSON()));\n    }\n  });\n  var conf = {\n    \"bookRegistry\": {\n      \"url\": \"http://henri-potier.xebia.fr/books\",\n      \"settings\": {\n        \"accepts\": [ \"text/json\" ],\n        \"cache\": false,\n        \"dataType\": \"json\",\n        \"ifModified\": true\n      }\n    }\n  };\n  domReady(function() {\n    $(\".button-collapse\").sideNav();\n    $(\".main-loader\").addClass(\"hidden\").hide();\n  });\n  var bookRegistryRequest = $.ajax(conf.bookRegistry.url, conf.bookRegistry.settings);\n  var books;\n  bookRegistryRequest.then(function bookRegistryRequestSuccess(data, status, jqXHR) {\n    var books = new baruchSpinoza.Collections.Book(data);\n    console.log(\"BOOKS: \", books);\n  }, function bookRegistryRequestFail(data, status, jqXHR) {\n    console.log(\"FAIL: \", arguments);\n  });\n});"],"sourceRoot":"/source/"}